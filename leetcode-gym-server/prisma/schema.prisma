datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

model User {
  id                 String   @id @default(uuid())
  email              String   @unique
  password           String
  createdAt          DateTime @default(now())
  preferredLanguage  String?  @default("cpp")
  groqApiKey         String?
  quickPrompts       String?  // JSON array of { label, text }
  logs               Log[]
}

model PasswordResetToken {
  id        String   @id @default(cuid())
  email     String
  token     String   @unique
  expiresAt DateTime
  createdAt DateTime @default(now())
}

model Log {
  id           String   @id @default(cuid())
  userId       String
  slug         String   // e.g., "two-sum"
  title        String
  difficulty   String   // "Easy", "Medium", "Hard" (User perception)
  confidence   Int      // 1 (Struggled) to 3 (Crushed it)
  reviewedAt   DateTime @default(now())
  nextReviewAt DateTime // Calculated date

  category     String?  @default("General") // e.g. "Two Pointers", "DFS"
  approach     String?  // Short summary of logic
  complexity   String?  // e.g. "O(n) time, O(1) space"
  codeSnippet  String?  // The core logic (not full boilerplate)

  // NEW TRACKING FIELDS
  timeTaken    Int?     // In seconds
  timeLimit    Int?     // In seconds (null if stopwatch mode)
  metTimeLimit Boolean? // True if finished before countdown hit 0
  
  // CODE STORAGE
  language     String?  // e.g. "python3", "cpp", "javascript"
  solution     String?  // The optimal code snippet
  
  user         User     @relation(fields: [userId], references: [id])
}